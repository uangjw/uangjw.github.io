<!DOCTYPE html><html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /><title>论文笔记||Sketch Generation with Drawing Process Guided by Vector Flow and Grayscale &mdash; Bird Nest</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/vendor/primer-css/css/primer.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/css/components/collection.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/css/components/repo-card.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/css/sections/repo-list.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/css/components/boxed-group.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/css/globals/common.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/css/globals/responsive.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/css/posts/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/vendor/octicons/octicons/octicons.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mzlogin/rouge-themes@master/dist/github.css"><link rel="canonical" href="https://uangjw.github.io/2021/11/12/paper-sktech-generation/"><link rel="alternate" type="application/atom+xml" title="Bird Nest" href="https://uangjw.github.io"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/favicon.ico"><meta property="og:title" content="论文笔记||Sketch Generation with Drawing Process Guided by Vector Flow and Grayscale"><meta name="keywords" content="NPR"><meta name="og:keywords" content="NPR"><meta name="description" content="生成笔触绘画过程："><meta name="og:description" content="生成笔触绘画过程："><meta property="og:url" content="https://uangjw.github.io/2021/11/12/paper-sktech-generation/"><meta property="og:site_name" content="Bird Nest"><meta property="og:type" content="article"><meta property="og:locale" content="zh_CN" /><meta property="article:published_time" content="2021-11-12"> <script src="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/vendor/jquery/dist/jquery.min.js"></script> <script src="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/js/jquery-ui.js"></script> <script src="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/js/main.js"></script></head><body class="" data-mz=""><header class="site-header"><div class="container"><h1><a href="https://uangjw.github.io/" title="Bird Nest"><span class="octicon octicon-mark-github"></span> Bird Nest</a></h1><button class="collapsed mobile-visible" type="button" onclick="toggleMenu();"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button><nav class="site-header-nav" role="navigation"> <a href="https://uangjw.github.io/" class=" site-header-nav-item" target="" title="Home">Home</a> <a href="https://uangjw.github.io/categories/" class=" site-header-nav-item" target="" title="Categories">Categories</a> <a href="https://uangjw.github.io/about/" class=" site-header-nav-item" target="" title="About">About</a></nav></div></header><section class="collection-head small geopattern" data-pattern-id="论文笔记||Sketch Ge"><div class="container"><div class="columns"><div class="column three-fourths"><div class="collection-title"><h1 class="collection-header">论文笔记||Sketch Generation with Drawing Process Guided by Vector Flow and Grayscale</h1><div class="collection-info"> <span class="meta-info"> <span class="octicon octicon-calendar"></span> 2021/11/12 </span> <span class="meta-info"> <span class="octicon octicon-file-directory"></span> <a href="https://uangjw.github.io/categories/#PaperNotes" title="PaperNotes">PaperNotes</a> </span> <span class="meta-info"> <span class="octicon octicon-clock"></span> 共 1514 字，约 5 分钟 </span></div></div></div><div class="column one-fourth mobile-hidden"><div class="collection-title"></div></div></div></div></section><section class="container content"><div class="columns"><div class="column three-fourths" ><article class="article-content markdown-body"><h3 id="生成笔触绘画过程">生成笔触绘画过程：</h3><h4 id="grayscale-guidance">Grayscale Guidance</h4><p>首先调整输入灰度图像的直方图，改善其色调hue；使用CLAHE加强输入图像的对比度</p><p>接着对输入图像的灰度量化为${G_1,G_2,…,G_n}$，由此步骤新生成的图像记为$Q$</p><p>按行扫描Q，每一行中具有小于等于灰度级G的灰度的像素被视为一个区间，这一区间的开始像素就是未来笔触的开始位置，灰度级G即为这一笔触的central pixel gray value mean；这样就可以把水平方向的笔触画出来了（笔触的宽度W是提前确定的，是一个用户可调节的参数）</p><p>利用这种方法，可以通过旋转Q来画出各个方向的笔触</p><h4 id="direction-guidance">Direction Guidance</h4><p>观察真实素描画可以看出，笔触的方向通常是沿着边缘的切线的</p><p>使用输入图像的梯度信息来做这个笔触方向的预测，因为梯度与边缘通常是紧密联系的。</p><p>使用ETF（edge tangent flow）来逐像素地估计笔触的方向。构造ETF的方法：</p><ol><li>计算每个像素的梯度向量的模和方向</li><li>将这些向量逆时针旋转90°</li><li>迭代地调整这些向量的方向，主要目的是让模长较小的向量的方向能够趋向模长较大的向量，即起到一个类似平滑的效果</li></ol><p>这样，各向量的方向就近似地与边缘平行了，我们得到了一个这些向量构成的分辨率与原图像相同的向量场。</p><p>接下来，将输入图像根据ETF划分为一定的区域。流程：</p><ol><li>将向量的方向从0到2pi量化到n个值，相位差为pi的两个向量被认为具有同一方向</li><li>将具有同一方向的向量对应的像素划分到一个区域</li></ol><p>分别在每个区域中绘制这一区域对应方向的笔触，就可以得到n个绘制结果，表示为${\beta_1, \beta_2, …, \beta_n}$。下一步就要将它们合并，得到整体的结果。</p><h4 id="area-merging-and-detail-enhancement">Area Merging and Detail Enhancement</h4><p>按笔触方向划分区域并分别进行绘制，会导致分区之间在相加后不能很好地融合到一起，且细小的分区中笔触也会很短小，整体看去就像噪声一样。文章解决这一问题的做法是将笔触的首尾延长2W个像素，W为笔触的宽度。</p><p>从分区结果得到最终结果的表达式：</p><p>$A=minimum(\beta_1, \beta_2, …, \beta_n)$</p><p>延长笔触之后细节的清晰度受到了影响。文章的做法是用线性卷积的方法计算edge map，然后将edge map与A相乘来得到加强细节的结果。</p><h4 id="process-reconstruction">Process Reconstruction</h4><p>为了生成更真实的绘画过程，作者将每一个笔触按$S$排序，$S$是作者设计的能够近似地表明笔触多大程度上是细节或轮廓的描绘的参数。实际实现中，作者用<code class="language-plaintext highlighter-rouge">importance</code>作为变量名。在生成绘制过程之前，先将所有笔触按$S$从大到小排序，然后按顺序将它们绘制到画布上即可。</p><p>$S=(255-G)\times \sum_{i\in D}T_i$</p><h3 id="改进尝试">改进尝试</h3><h4 id="area-merging">Area Merging</h4><p>为了解决按方向划分的区域之间不能很好衔接的问题，作者直接将每个笔触延长2W个像素，这样使得结果中细节丢失很严重。作者想通过乘上一个edge map来解决这个问题，但这样并不能弥补高光之类的具有大灰度值的细节丢失。</p><p><img src="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/images/image-20211110210919830.png" div="" align="center" /></p><p>我将延长笔触的部分改为：</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">extend_len</span> <span class="o">=</span> <span class="n">stroke_temp</span><span class="p">[</span><span class="s">'grayscale'</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span> <span class="o">*</span> <span class="n">period</span> <span class="o">+</span> <span class="n">period</span>
<span class="n">begin</span> <span class="o">-=</span> <span class="nb">int</span><span class="p">(</span><span class="n">extend_len</span><span class="p">)</span>
<span class="n">end</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">extend_len</span><span class="p">)</span>
</code></pre></div></div><p>即深色部分的笔触延长较短长度，浅色部分的笔触延长较长长度。</p><p>改进并不明显……（未加edge图）</p><p><img src="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/images/image-20211111003227879.png" alt="image-20211111003227879" style="zoom: 33%;" /> <img src="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/images/image-20211111004120087.png" alt="image-20211111004120087" style="zoom: 33%;" /></p><p>眼睛的细节看起来保持得稍好一些，主要是像眼白这样小块的浅色区域，没有因为笔触的过分延长而变得太深</p><p><img src="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/images/image-20211111004358482.png" alt="image-20211111004358482" style="zoom: 25%;" /> <img src="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/images/image-20211111004429733.png" alt="image-20211111004429733" style="zoom: 25%;" /></p><p>对于非真实感渲染的效果改进往往是建立在非常主观的感受之上的。</p><p>我希望能找到一个保持高光的改进方法，找不到算了</p><div style="margin-top:2em;padding:0 1.5em;border:1px solid #d3d3d3;background-color:#deebf7"><h3>文档信息</h3><ul><li>本文作者：<a href="https://uangjw.github.io" target="_blank">Jingwen Huang</a></li><li>本文链接：<a href="https://uangjw.github.io/2021/11/12/paper-sktech-generation/" target="_blank">https://uangjw.github.io/2021/11/12/paper-sktech-generation/</a></li><li>版权声明：自由转载-非商用-非衍生-保持署名（<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">创意共享3.0许可证</a>）</li></ul></div></article><div class="share"></div><div class="comment"></div></div><div class="column one-fourth"><h3>Search</h3><div id="site_search"> <input style="width:96%" type="text" id="search_box" placeholder="Search"></div><ul id="search_results" style="font-size:14px;list-style-type:none;padding-top:10px;padding-left:10px;"></ul><script src="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/js/simple-jekyll-search.min.js"></script> <script type="text/javascript"> SimpleJekyllSearch({ searchInput: document.getElementById('search_box'), resultsContainer: document.getElementById('search_results'), json: 'https://uangjw.github.io/assets/search_data.json', searchResultTemplate: '<li><a href="{url}" title="{title}">{title}</a></li>', noResultsText: 'No results found', limit: 10, fuzzy: false, exclude: ['Welcome'] }) </script><h3 class="post-directory-title mobile-hidden">Table of Contents</h3><div id="post-directory-module" class="mobile-hidden"><section class="post-directory"><dl></dl></section></div><script src="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/js/jquery.toc.js"></script></div></div></section><footer class="container"><div class="site-footer" role="contentinfo"><div class="copyright left mobile-block"> © 2021 <span title="Jingwen Huang">Jingwen Huang</span> <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a></div><ul class="site-footer-links right mobile-hidden"><li> <a href="javascript:window.scrollTo(0,0)" >TOP</a></li></ul><a href="https://github.com/uangjw/uangjw.github.io" target="_blank" aria-label="view source code"> <span class="mega-octicon octicon-mark-github" title="GitHub"></span> </a><ul class="site-footer-links mobile-hidden"><li> <a href="https://uangjw.github.io/" title="Home" target="">Home</a></li><li> <a href="https://uangjw.github.io/categories/" title="Categories" target="">Categories</a></li><li> <a href="https://uangjw.github.io/about/" title="About" target="">About</a></li><li><a href="https://uangjw.github.io"><span class="octicon octicon-rss" style="color:orange;"></span></a></li></ul><script async src="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/vendor/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="mobile-hidden" style="margin-top:8px"> <span id="busuanzi_container_site_pv" style="display:none"> 本站访问量<span id="busuanzi_value_site_pv"></span>次 </span> <span id="busuanzi_container_site_uv" style="display:none"> / 本站访客数<span id="busuanzi_value_site_uv"></span>人 </span> <span id="busuanzi_container_page_pv" style="display:none"> / 本页访问量<span id="busuanzi_value_page_pv"></span>次 / 统计始于2021-03-10 </span></div></div></footer><div class="tools-wrapper"> <a class="gotop" href="#" title="回到顶部"><span class="octicon octicon-arrow-up"></span></a></div><script src="https://cdn.jsdelivr.net/gh/uangjw/uangjw.github.io@master/assets/js/geopattern.js"></script> <script> jQuery(document).ready(function($) { $('.geopattern').each(function(){ $(this).geopattern($(this).data('pattern-id')); }); /* hljs.initHighlightingOnLoad(); */ }); </script><div style="display:none"> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-80669434-1', 'auto'); ga('send', 'pageview'); </script></div></body></html>
